<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.8"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>ETA/OS: Coding style</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="doxygen-bootstrap.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
		<div class="row">
		    <div class="col-sm-2 logo">
			<img class="logo" alt="Logo" src="etaos-logo.svg"/>
		    </div>
		    <div class="col-sm-2 project-number">
                        <a class="navbar-brand">5.1.6</a>
		    </div>
	        </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Coding style </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#cs">Coding style</a><ul><li class="level2"><a href="#ind">Indentation</a><ul><li class="level3"><a href="#indent-switch">Switch statements</a></li>
</ul>
</li>
<li class="level2"><a href="#long-lines">Breaking long lines</a></li>
<li class="level2"><a href="#brace-space">Braces and spaces</a></li>
<li class="level2"><a href="#comments">Comments</a></li>
</ul>
</li>
<li class="level1"><a href="#patches">Patches</a><ul><li class="level2"><a href="#cre-patch">Creating patches</a></li>
<li class="level2"><a href="#snt-patch">Sending patches</a></li>
<li class="level2"><a href="#clients">Email clients</a><ul><li class="level3"><a href="#evol">Evolution</a></li>
<li class="level3"><a href="#mutt">Mutt</a></li>
<li class="level3"><a href="#thunder">Thunderbird</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>ETA/OS is free, open source software and is currently maintained and written by hobbyists. All help to make ETA/OS a better system is welcome ofcourse, but in order to keep things simple there are some regulations or 'best practises'. Please read them carefully if you are planning to send a patch.</p>
<h1><a class="anchor" id="cs"></a>
Coding style</h1>
<p>This is probably the most important section of this entire document. Coding style is VERRY important and patches with a bad coding style will be rejected. If you want an example of a bad coding style; read the GNU coding style (burn it after you're done, though).</p>
<h2><a class="anchor" id="ind"></a>
Indentation</h2>
<p>Indentation is done using tabs, and tabs are 8 characters long. There are some disgusting movements on the web trying to change standards to 4 or even 2 characters (<em>cough</em> hello Ruby <em>cough</em>). All this nonsense should be ignored. <b>Patches not using 8-character indentation will be rejected.</b></p>
<p>Now the main 'issue' with 8 character indents is that nested indentations move your code over the 80 character limit way to fast. The actual issue is that you have to many indentation levels and you should stop producing 'wtf code'.</p>
<p>Don't ever put statements on a single line. Use</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span>(<a class="code" href="structcondition.html">condition</a>)</div>
<div class="line">      yo_bro();</div>
</div><!-- fragment --><p>instead of</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span>(<a class="code" href="structcondition.html">condition</a>) yo_bro();</div>
</div><!-- fragment --><h3><a class="anchor" id="indent-switch"></a>
Switch statements</h3>
<p>Switch statements are somewhat special. Don't double indent the case statements. A proper example of a switch statement </p><div class="fragment"><div class="line"><span class="keywordflow">switch</span>(letter) {</div>
<div class="line"><span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span>:</div>
<div class="line"><span class="keywordflow">case</span> <span class="charliteral">&#39;A&#39;</span>:</div>
<div class="line">      puts(<span class="stringliteral">&quot;Right answer!\n&quot;</span>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">default</span>:</div>
<div class="line">        puts(<span class="stringliteral">&quot;Wrong answer!\n&quot;</span>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="long-lines"></a>
Breaking long lines</h2>
<p>Statements longer than 80 columns will be broken into sensible chunks, unless exceeding 80 columns significantly increases readability and does not hide information. Descendants are always substantially shorter than the parent and are placed substantially to the right. The same applies to function headers with a long argument list. However, never break user-visible strings such as printk messages, because that breaks the ability to grep for them.</p>
<h2><a class="anchor" id="brace-space"></a>
Braces and spaces</h2>
<p>The next issue that always comes up when its about C/C++ coding style is the placement of braces.</p>
<p>The general rule is, place the opening brace on the same line as the statement and the closing brace on the next empty line. The only exception to this rule are functions, where both braces are placed on an empty line.</p>
<p>Function example: </p><div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> <span class="keyword">function</span>(<span class="keyword">struct </span>astruct *sp)</div>
<div class="line">{</div>
<div class="line">        <span class="keyword">function</span> body</div>
<div class="line">}</div>
</div><!-- fragment --><p>Normal example: </p><div class="fragment"><div class="line"><span class="keywordflow">if</span>(<a class="code" href="structcondition.html">condition</a> is <span class="keyword">true</span>) {</div>
<div class="line">        <span class="keywordflow">do</span> <span class="keyword">this</span>;</div>
<div class="line">        and that;</div>
<div class="line">}</div>
</div><!-- fragment --><p>As said the closing brace is on the next empty line, except in the cases where it is followed by a continuation of the same statement (i.e. do-while, if-else).</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span>(<a class="code" href="structcondition.html">condition</a> is <span class="keyword">true</span>) {</div>
<div class="line">        <span class="keywordflow">do</span> <span class="keyword">this</span>;</div>
<div class="line">        and that;</div>
<div class="line">} <span class="keywordflow">else</span> <span class="keywordflow">if</span>(another <a class="code" href="structcondition.html">condition</a> is <span class="keyword">true</span>) {</div>
<div class="line">        <span class="keywordflow">do</span> it now then;</div>
<div class="line">        sup_brah();</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">        <a class="code" href="group__python-sys.html#gabf45d6eb9e0803f71b96387da92c03e6">exit</a>();</div>
<div class="line">}</div>
</div><!-- fragment --><p>Do not place braces when they are not necessary:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span>(<a class="code" href="structcondition.html">condition</a> is <span class="keyword">true</span>)</div>
<div class="line">      do_this;</div>
</div><!-- fragment --><p>The last rule doesn't apply when only 1 branch of a conditional statement is a single line:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span>(<a class="code" href="structcondition.html">condition</a> is <span class="keyword">true</span>) {</div>
<div class="line">      do_this;</div>
<div class="line">      do_that;</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">        otherwise();</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="comments"></a>
Comments</h2>
<p>Comments are good, but there is also a danger of over-commenting. NEVER try to explain HOW your code works in a comment: it's much better to write the code so that the <em>working</em> is obvious, and it's a waste of time to explain badly written code.</p>
<p>Generally, you want your comments to tell WHAT your code does, not HOW. Also, try to avoid putting comments inside a function body: if the function is so complex that you need to separately comment parts of it, you should probably go back to chapter 6 for a while. You can make small comments to note or warn about something particularly clever (or ugly), but try to avoid excess. Instead, put the comments at the head of the function, telling people what it does, and possibly WHY it does it.</p>
<p>All public API functions should be documented according to the Doxygen standard.</p>
<p>C99 style (// comment) comments are allowed, but only for single line comments. All comments using multiple lines should use the ANSI style.</p>
<h1><a class="anchor" id="patches"></a>
Patches</h1>
<p>Now then. Lets imagine that you have written some code or fixed up some existing code and you want it to stick it into the main stream ETA/OS repository. There's a few options you have, sending a patch using email (preferred, and required with small patches) or sending a pull request.</p>
<p>Pull requests are only an option when you are submitting a large patch. In this case, large is defined as 10 commits and more. A succesful pull request contains: </p><pre class="fragment">    a link to your git repository
    a specification of the branch you want mainstream
    a summary of what you've been doing
</pre><p>All patches that are 1-9 commits are to be sent by email.</p>
<h2><a class="anchor" id="cre-patch"></a>
Creating patches</h2>
<p>An explanation on how you should create your patch patch. Lets say, that your patch is 2 commits long and you want to generate the .patch files.</p>
<p>Enter the following command: </p><div class="fragment"><div class="line">git format-patch --to etaos@googlegroups.net HEAD~2..HEAD</div>
</div><!-- fragment --><p>git format-patch will generate a patch-file-per-commit of the given range (which is HEAD-2 to HEAD in our case). The &ndash;to argument is used to set a receiver which will be used later on by git send-email.</p>
<h2><a class="anchor" id="snt-patch"></a>
Sending patches</h2>
<p>Once your patch has been created sent them <b>inline</b> to the ETA/OS mailing list (<a href="#" onclick="location.href='mai'+'lto:'+'eta'+'os'+'@go'+'og'+'leg'+'ro'+'ups'+'.n'+'et'; return false;">etaos<span style="display: none;">.nosp@m.</span>@goo<span style="display: none;">.nosp@m.</span>glegr<span style="display: none;">.nosp@m.</span>oups<span style="display: none;">.nosp@m.</span>.net</a>). If you want to you can also CC the maintainer of the file you have patched, his or her email should be in the top of the file.</p>
<p>To send your email using git, run the following command:</p>
<div class="fragment"><div class="line">git send-email *.patch</div>
</div><!-- fragment --><p>To use git send-email, you need to have it configured. To do so, please read the git scm documentation on `git send-email'.</p>
<p>Patches can also be manually sent using email clients. Please note that patches should be sent as plain text. No MIME, links, compression or attachments.</p>
<p>Exception to the rule: if your email client is mangling up your patch a maintainer may ask you to resend it using MIME or attachments.</p>
<h2><a class="anchor" id="clients"></a>
Email clients</h2>
<p>Below follow some email settings which make sure that your patch arrives as a clean plain-text patch.</p>
<h3><a class="anchor" id="evol"></a>
Evolution</h3>
<p>Some people use this successfully for patches.</p>
<p>When composing mail select: Preformat from Format-&gt;Heading-&gt;Preformatted (Ctrl-7) or the toolbar</p>
<p>Then use: Insert-&gt;Text File... (Alt-n x) to insert the patch.</p>
<p>You can also "diff -Nru old.c new.c | xclip", select Preformat, then paste with the middle button.</p>
<h3><a class="anchor" id="mutt"></a>
Mutt</h3>
<p>This editor is most likely going to be the most succesful for sending plain-text patches.</p>
<p>Mutt doesn't come with an editor, so whatever editor you use should be used in a way that there are no automatic linebreaks. Most editors have an "insert file" option that inserts the contents of a file unaltered.</p>
<p>To use 'vim' with mutt: set editor="vi"</p>
<p>If using xclip, type the command</p><ul>
<li>:set paste</li>
<li>before middle button</li>
<li>shift-insert</li>
<li>use :r filename</li>
</ul>
<p>If you want to include the patch inline. (a)ttach works fine without "set paste".</p>
<p>Config options: It should work with default settings. However, it's a good idea to set the "send_charset" to: set send_charset="us-ascii:utf-8"</p>
<h3><a class="anchor" id="thunder"></a>
Thunderbird</h3>
<p>Thunderbird is an Outlook clone that likes to mangle text, but there are ways to coerce it into behaving.</p>
<ul>
<li>Allows use of an external editor: The easiest thing to do with Thunderbird and patches is to use an "external editor" extension and then just use your favorite $EDITOR for reading/merging patches into the body text. To do this, download and install the extension, then add a button for it using View-&gt;Toolbars-&gt;Customize... and finally just click on it when in the Compose dialog.</li>
</ul>
<p>To beat some sense out of the internal editor, do this:</p>
<ul>
<li>Edit your Thunderbird config settings so that it won't use format=flowed. Go to "edit-&gt;preferences-&gt;advanced-&gt;config editor" to bring up the thunderbird's registry editor.</li>
<li>Set "mailnews.send_plaintext_flowed" to "false"</li>
<li>Set "mailnews.wraplength" from "72" to "0"</li>
<li>"View" &gt; "Message Body As" &gt; "Plain Text"</li>
<li>"View" &gt; "Character Encoding" &gt; "Unicode (UTF-8)" </li>
</ul>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>
Generated on Wed Nov 8 2017 19:31:59 for ETA/OS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
